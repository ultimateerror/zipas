var me=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ke=me((Ve,de)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function te(){document.querySelector("#entries").innerHTML="",document.querySelector("#message-zipcorruption").hidden=!0}function re(t){return t.arrayBuffer?t.arrayBuffer():new Promise((e,r)=>{const n=new FileReader;n.addEventListener("loadend",()=>{e(n.result)}),n.addEventListener("error",r),n.readAsArrayBuffer(t)})}async function pe(t){const e=await re(t);return new Uint8Array(e)}function ne(t){return typeof Blob<"u"&&t instanceof Blob}function k(t){return typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}const he=typeof process<"u"&&process.versions&&typeof process.versions.node<"u"&&typeof process.versions.electron>"u";function we(t){return t.byteOffset===0&&t.byteLength===t.buffer.byteLength}class J{constructor(e){this.typedArray=e instanceof ArrayBuffer||k(e)?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}async getLength(){return this.typedArray.byteLength}async read(e,r){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+e,r)}}class K{constructor(e){this.blob=e}async getLength(){return this.blob.size}async read(e,r){const n=this.blob.slice(e,e+r),i=await re(n);return new Uint8Array(i)}async sliceAsBlob(e,r,n=""){return this.blob.slice(e,e+r,n)}}function ye(t,e){var r=Uint8Array;if(t[0]==3&&t[1]==0)return e||new r(0);var n=ve,i=ie,o=ge,a=oe,f=e==null;f&&(e=new r(t.length>>>2<<3));for(var l=0,p=0,u=0,d=0,y=0,c=0,E=0,h=0,m=0,A,S;l==0;){if(l=n(t,m,1),p=n(t,m+1,2),m+=3,p==0){(m&7)!=0&&(m+=8-(m&7));var g=(m>>>3)+4,x=t[g-4]|t[g-3]<<8;f&&(e=I(e,h+x)),e.set(new r(t.buffer,t.byteOffset+g,x),h),m=g+x<<3,h+=x;continue}if(f&&(e=I(e,h+(1<<17))),p==1&&(A=s.flmap,S=s.fdmap,c=511,E=31),p==2){u=i(t,m,5)+257,d=i(t,m+5,5)+1,y=i(t,m+10,4)+4,m+=14;for(var w=0;w<38;w+=2)s.itree[w]=0,s.itree[w+1]=0;for(var L=1,w=0;w<y;w++){var T=i(t,m+w*3,3);s.itree[(s.ordr[w]<<1)+1]=T,T>L&&(L=T)}m+=3*y,F(s.itree,L),U(s.itree,L,s.imap),A=s.lmap,S=s.dmap,m=o(s.imap,(1<<L)-1,u+d,t,m,s.ttree);var C=X(s.ttree,0,u,s.ltree);c=(1<<C)-1;var M=X(s.ttree,u,d,s.dtree);E=(1<<M)-1,F(s.ltree,C),U(s.ltree,C,A),F(s.dtree,M),U(s.dtree,M,S)}for(;;){var Y=A[a(t,m)&c];m+=Y&15;var B=Y>>>4;if(!(B>>>8))e[h++]=B;else{if(B==256)break;var $=h+B-254;if(B>264){var P=s.ldef[B-257];$=h+(P>>>3)+i(t,m,P&7),m+=P&7}var Q=S[a(t,m)&E];m+=Q&15;var ue=Q>>>4,H=s.ddef[ue],R=(H>>>4)+n(t,m,H&15);for(m+=H&15,f&&(e=I(e,h+(1<<17)));h<$;)e[h]=e[h++-R],e[h]=e[h++-R],e[h]=e[h++-R],e[h]=e[h++-R];h=$}}}return e.length==h?e:e.slice(0,h)}function I(t,e){var r=t.length;if(e<=r)return t;var n=new Uint8Array(Math.max(r<<1,e));return n.set(t,0),n}function ge(t,e,r,n,i,o){for(var a=ie,f=oe,l=0;l<r;){var p=t[f(n,i)&e];i+=p&15;var u=p>>>4;if(u<=15)o[l]=u,l++;else{var d=0,y=0;u==16?(y=3+a(n,i,2),i+=2,d=o[l-1]):u==17?(y=3+a(n,i,3),i+=3):u==18&&(y=11+a(n,i,7),i+=7);for(var c=l+y;l<c;)o[l]=d,l++}}return i}function X(t,e,r,n){for(var i=0,o=0,a=n.length>>>1;o<r;){var f=t[o+e];n[o<<1]=0,n[(o<<1)+1]=f,f>i&&(i=f),o++}for(;o<a;)n[o<<1]=0,n[(o<<1)+1]=0,o++;return i}function F(t,e){for(var r=t.length,n,i,o,a,f,l=s.bl_count,a=0;a<=e;a++)l[a]=0;for(a=1;a<r;a+=2)l[t[a]]++;var p=s.next_code;for(n=0,l[0]=0,i=1;i<=e;i++)n=n+l[i-1]<<1,p[i]=n;for(o=0;o<r;o+=2)f=t[o+1],f!=0&&(t[o]=p[f],p[f]++)}function U(t,e,r){for(var n=t.length,i=s.rev15,o=0;o<n;o+=2)if(t[o+1]!=0)for(var a=o>>1,f=t[o+1],l=a<<4|f,p=e-f,u=t[o]<<p,d=u+(1<<p);u!=d;){var y=i[u]>>>15-e;r[y]=l,u++}}function V(t,e){for(var r=s.rev15,n=15-e,i=0;i<t.length;i+=2){var o=t[i]<<e-t[i+1];t[i]=r[o]>>>n}}function ie(t,e,r){return(t[e>>>3]|t[(e>>>3)+1]<<8)>>>(e&7)&(1<<r)-1}function ve(t,e,r){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(e&7)&(1<<r)-1}function oe(t,e){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(e&7)}const s=function(){var t=Uint16Array,e=Uint32Array;return{next_code:new t(16),bl_count:new t(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new t(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new t(512),fltree:[],fdmap:new t(32),fdtree:[],lmap:new t(32768),ltree:[],ttree:[],dmap:new t(32768),dtree:[],imap:new t(512),itree:[],rev15:new t(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new t(65536),prev:new t(32768)}}();(function(){for(var t=32768,e=0;e<t;e++){var r=e;r=(r&2863311530)>>>1|(r&1431655765)<<1,r=(r&3435973836)>>>2|(r&858993459)<<2,r=(r&4042322160)>>>4|(r&252645135)<<4,r=(r&4278255360)>>>8|(r&16711935)<<8,s.rev15[e]=(r>>>16|r<<16)>>>17}function n(i,o,a){for(;o--!=0;)i.push(0,a)}for(var e=0;e<32;e++)s.ldef[e]=s.of0[e]<<3|s.exb[e],s.ddef[e]=s.df0[e]<<4|s.dxb[e];n(s.fltree,144,8),n(s.fltree,112,9),n(s.fltree,24,7),n(s.fltree,8,8),F(s.fltree,9),U(s.fltree,9,s.flmap),V(s.fltree,9),n(s.fdtree,32,5),F(s.fdtree,5),U(s.fdtree,5,s.fdmap),V(s.fdtree,5),n(s.itree,19,0),n(s.ltree,286,0),n(s.dtree,30,0),n(s.ttree,320,0)})();(function(){for(var t=new Uint32Array(256),e=0;e<256;e++){for(var r=e,n=0;n<8;n++)r&1?r=3988292384^r>>>1:r=r>>>1;t[e]=r}return t})();function be(t,e){return ye(t,e)}const ee={numWorkers:1,workerURL:"",useWorkers:!1};let xe=0;const D=[];function q(t){return new Promise((e,r)=>{const n=new Worker(t);n.onmessage=i=>{i.data==="start"?(n.onerror=void 0,n.onmessage=void 0,e(n)):r(new Error(`unexpected message: ${i.data}`))},n.onerror=r})}function Ee(t,e){return t.require?t.require(e):{}}(function(){if(he){const{Worker:t}=Ee(de,"worker_threads");return{async createWorker(e){return new t(e)},addEventListener(e,r){e.on("message",n=>{r({target:e,data:n})})},async terminate(e){await e.terminate()}}}else return{async createWorker(t){try{return await q(t)}catch{console.warn("could not load worker:",t)}let e;try{const r=await fetch(t,{mode:"cors"});if(!r.ok)throw new Error(`could not load: ${t}`);e=await r.text(),t=URL.createObjectURL(new Blob([e],{type:"application/javascript"}));const n=await q(t);return ee.workerURL=t,n}catch{console.warn("could not load worker via fetch:",t)}if(e!==void 0)try{t=`data:application/javascript;base64,${btoa(e)}`;const r=await q(t);return ee.workerURL=t,r}catch{console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(t,e){t.addEventListener("message",e)},async terminate(t){t.terminate()}}})();function Le(t,e,r,n){const i=new Uint8Array(e);be(t,i),n(r?new Blob([i],{type:r}):i.buffer)}async function Ae(){if(D.length!==0)for(;D.length;){const{src:t,uncompressedSize:e,type:r,resolve:n}=D.shift();let i=t;ne(t)&&(i=await pe(t)),Le(i,e,r,n)}}function ae(t,e,r){return new Promise((n,i)=>{D.push({src:t,uncompressedSize:e,type:r,resolve:n,reject:i,id:xe++}),Ae()})}function Se(t,e){const r=t&31,n=(t>>5&15)-1,i=(t>>9&127)+1980,o=0,a=(e&31)*2,f=e>>5&63,l=e>>11&31;return new Date(i,n,r,l,f,a,o)}class ze{constructor(e,r){this._reader=e,this._rawEntry=r,this.name=r.name,this.nameBytes=r.nameBytes,this.size=r.uncompressedSize,this.compressedSize=r.compressedSize,this.comment=r.comment,this.commentBytes=r.commentBytes,this.compressionMethod=r.compressionMethod,this.lastModDate=Se(r.lastModFileDate,r.lastModFileTime),this.isDirectory=r.uncompressedSize===0&&r.name.endsWith("/"),this.encrypted=!!(r.generalPurposeBitFlag&1),this.externalFileAttributes=r.externalFileAttributes,this.versionMadeBy=r.versionMadeBy}async blob(e="application/octet-stream"){return await Ce(this._reader,this._rawEntry,e)}async arrayBuffer(){return await Te(this._reader,this._rawEntry)}async text(){const e=await this.arrayBuffer();return _(new Uint8Array(e))}async json(){const e=await this.text();return JSON.parse(e)}}const W=22,Be=65535,Oe=101010256,Fe=101075792;async function O(t,e,r){return await t.read(e,r)}async function j(t,e,r,n){return t.sliceAsBlob?await t.sliceAsBlob(e,r,n):await t.read(e,r)}const Ue={unsigned(){return 0}};function v(t,e){return t[e]+t[e+1]*256}function b(t,e){return t[e]+t[e+1]*256+t[e+2]*65536+t[e+3]*16777216}function z(t,e){return b(t,e)+b(t,e+4)*4294967296}const _e=new TextDecoder;function _(t,e){return k(t.buffer)&&(t=new Uint8Array(t)),_e.decode(t)}async function ke(t,e){const r=Math.min(W+Be,e),n=e-r,i=await O(t,n,r);for(let o=r-W;o>=0;--o){if(b(i,o)!==Oe)continue;const a=new Uint8Array(i.buffer,i.byteOffset+o,i.byteLength-o),f=v(a,4);if(f!==0)throw new Error(`multi-volume zip files are not supported. This is volume: ${f}`);const l=v(a,10),p=b(a,12),u=b(a,16),d=v(a,20),y=a.length-W;if(d!==y)throw new Error(`invalid comment length. expected: ${y}, actual: ${d}`);const c=new Uint8Array(a.buffer,a.byteOffset+22,d),E=_(c);return l===65535||u===4294967295?await De(t,n+o,E,c):await se(t,u,p,l,E,c)}throw new Error("could not find end of central directory. maybe not zip file")}const Re=117853008;async function De(t,e,r,n){const i=e-20,o=await O(t,i,20);if(b(o,0)!==Re)throw new Error("invalid zip64 end of central directory locator signature");const a=z(o,8),f=await O(t,a,56);if(b(f,0)!==Fe)throw new Error("invalid zip64 end of central directory record signature");const l=z(f,32),p=z(f,40),u=z(f,48);return se(t,u,p,l,r,n)}const Ne=33639248;async function se(t,e,r,n,i,o){let a=0;const f=await O(t,e,r),l=[];for(let u=0;u<n;++u){const d=f.subarray(a,a+46),y=b(d,0);if(y!==Ne)throw new Error(`invalid central directory file header signature: 0x${y.toString(16)}`);const c={versionMadeBy:v(d,4),versionNeededToExtract:v(d,6),generalPurposeBitFlag:v(d,8),compressionMethod:v(d,10),lastModFileTime:v(d,12),lastModFileDate:v(d,14),crc32:b(d,16),compressedSize:b(d,20),uncompressedSize:b(d,24),fileNameLength:v(d,28),extraFieldLength:v(d,30),fileCommentLength:v(d,32),internalFileAttributes:v(d,36),externalFileAttributes:b(d,38),relativeOffsetOfLocalHeader:b(d,42)};if(c.generalPurposeBitFlag&64)throw new Error("strong encryption is not supported");a+=46;const E=f.subarray(a,a+c.fileNameLength+c.extraFieldLength+c.fileCommentLength);c.nameBytes=E.slice(0,c.fileNameLength),c.name=_(c.nameBytes);const h=c.fileNameLength+c.extraFieldLength,m=E.slice(c.fileNameLength,h);c.extraFields=[];let A=0;for(;A<m.length-3;){const g=v(m,A+0),x=v(m,A+2),w=A+4,L=w+x;if(L>m.length)throw new Error("extra field length exceeds extra field buffer size");c.extraFields.push({id:g,data:m.slice(w,L)}),A=L}if(c.commentBytes=E.slice(h,h+c.fileCommentLength),c.comment=_(c.commentBytes),a+=E.length,c.uncompressedSize===4294967295||c.compressedSize===4294967295||c.relativeOffsetOfLocalHeader===4294967295){const g=c.extraFields.find(L=>L.id===1);if(!g)throw new Error("expected zip64 extended information extra field");const x=g.data;let w=0;if(c.uncompressedSize===4294967295){if(w+8>x.length)throw new Error("zip64 extended information extra field does not include uncompressed size");c.uncompressedSize=z(x,w),w+=8}if(c.compressedSize===4294967295){if(w+8>x.length)throw new Error("zip64 extended information extra field does not include compressed size");c.compressedSize=z(x,w),w+=8}if(c.relativeOffsetOfLocalHeader===4294967295){if(w+8>x.length)throw new Error("zip64 extended information extra field does not include relative header offset");c.relativeOffsetOfLocalHeader=z(x,w),w+=8}}const S=c.extraFields.find(g=>g.id===28789&&g.data.length>=6&&g.data[0]===1&&b(g.data,1),Ue.unsigned(c.nameBytes));if(S&&(c.fileName=_(S.data.slice(5))),c.compressionMethod===0){let g=c.uncompressedSize;if((c.generalPurposeBitFlag&1)!==0&&(g+=12),c.compressedSize!==g)throw new Error(`compressed size mismatch for stored file: ${c.compressedSize} != ${g}`)}l.push(c)}return{zip:{comment:i,commentBytes:o},entries:l.map(u=>new ze(t,u))}}async function ce(t,e){if(e.generalPurposeBitFlag&1)throw new Error("encrypted entries not supported");const r=await O(t,e.relativeOffsetOfLocalHeader,30),n=await t.getLength(),i=b(r,0);if(i!==67324752)throw new Error(`invalid local file header signature: 0x${i.toString(16)}`);const o=v(r,26),a=v(r,28),f=e.relativeOffsetOfLocalHeader+r.length+o+a;let l;if(e.compressionMethod===0)l=!1;else if(e.compressionMethod===8)l=!0;else throw new Error(`unsupported compression method: ${e.compressionMethod}`);const p=f,u=p+e.compressedSize;if(e.compressedSize!==0&&u>n)throw new Error(`file data overflows file bounds: ${p} +  ${e.compressedSize}  > ${n}`);return{decompress:l,fileDataStart:p}}async function Te(t,e){const{decompress:r,fileDataStart:n}=await ce(t,e);if(!r){const a=await O(t,n,e.compressedSize);return we(a)?a.buffer:a.slice().buffer}const i=await j(t,n,e.compressedSize);return await ae(i,e.uncompressedSize)}async function Ce(t,e,r){const{decompress:n,fileDataStart:i}=await ce(t,e);if(!n){const f=await j(t,i,e.compressedSize,r);return ne(f)?f:new Blob([k(f.buffer)?new Uint8Array(f):f],{type:r})}const o=await j(t,i,e.compressedSize);return await ae(o,e.uncompressedSize,r)}async function Me(t){let e;if(typeof Blob<"u"&&t instanceof Blob)e=new K(t);else if(t instanceof ArrayBuffer||t&&t.buffer&&t.buffer instanceof ArrayBuffer)e=new J(t);else if(k(t)||k(t.buffer))e=new J(t);else if(typeof t=="string"){const n=await fetch(t);if(!n.ok)throw new Error(`failed http request ${t}, status: ${n.status}: ${n.statusText}`);const i=await n.blob();e=new K(i)}else if(typeof t.getLength=="function"&&typeof t.read=="function")e=t;else throw new Error("unsupported source type");const r=await e.getLength();if(r>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${r}. Only file sizes up 4503599627370496 bytes are supported`);return await ke(e,r)}function fe(t){return`.${t.split(".").at(-1)}`}function N(t){const e=fe(t);switch(e){case".apng":case".avif":case".bmp":case".gif":case".heic":case".heif":case".jpeg":case".png":case".raw":case".tif":case".tiff":case".webp":return`image/${e.replace(".","")}`;case".jfif":case".jpg":return"image/jpeg";case".svg":case".svgz":return"image/svg+xml"}return"application/octet-stream"}let Z;function $e(){Z=void 0}function Pe(){return Z?.filter(t=>N(t.name).startsWith("image/"))}function He(t){Z=t.entries}const le=!!window.showOpenFilePicker&&typeof window.showOpenFilePicker=="function";(function(){document.querySelector("#message-unsupportedbrowser").hidden=le})();function G(t){const[e,...r]=t.split("/").reverse();return[e,`${r.reverse().join("/")}${r.length?"/":""}`]}const Ie=Intl.NumberFormat("en",{notation:"compact",style:"unit",unit:"byte",unitDisplay:"narrow"});function qe(t){t.toString().startsWith("AbortError")||(document.querySelector("#message-zipcorruption").hidden=!1)}async function We(){return(await window.showOpenFilePicker({types:[{description:"Zip",accept:{"application/zip":[".zip"]}}],excludeAcceptAllOption:!0,multiple:!1}).catch(qe))?.at(0)?.getFile()}async function je(t){const e=le?await We():t.target.files?.[0];Ze(e)}async function Ze(t){if(te(),$e(),!t?.name)return;document.querySelector("#filename").innerHTML=t.name;const e=await Me(t);He(e);const r=await Ge(e);document.querySelector("#entries")?.append(...r)}async function Ge(t){return t.entries.filter(({size:e})=>!!e).map(({name:e,size:r,blob:n})=>{const[i,o]=G(e),a=document.createElement("strong");a.textContent=i;const f=document.createElement("span");f.textContent=o;const l=document.createElement("span");l.append(f,a);const p=document.createElement("small");p.textContent=Ie.format(r);const u=document.createElement("span");u.classList.add("name"),u.append(l,p);const d=document.createElement("button");d.textContent="💾 save",d.addEventListener("click",()=>Ye(e,n));const y=document.createElement("label");return y.setAttribute("for",e),y.append(u,d),y.dataset.mimetype=N(e),y})}async function Ye(t,e){const r=N(t),[n]=G(t),o=await(await window.showSaveFilePicker({suggestedName:n,types:[{accept:{[r]:[fe(t)]}}]})).createWritable(),a=await e(r);await o.write(a),await o.close()}async function Qe(t,e){const[r]=G(t),n=document.createElement("a");document.body.append(n),n.hidden=!0;const i=window.URL.createObjectURL(e);n.href=i,n.download=r,n.click(),window.URL.revokeObjectURL(i)}async function Je(){Pe()?.forEach(async t=>Qe(t.name,await t.blob(N(t.name))))}document.querySelector("#loadzip")?.addEventListener("click",je);document.querySelector("#unloadzip")?.addEventListener("click",te);document.querySelector("#saveall")?.addEventListener("click",Je)});export default Ke();
